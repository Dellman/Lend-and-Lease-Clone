<form novalidate>
    <label for="itemName">Item Name</label>
    <input type="text" name="itemName" id="itemName" value="Fill in the item Name" ng-model="item.name">
    <br>
    <br>
    <label for="itemCategory">Category</label>
    <select id="itemCategory" ng-model="prop.value" ng-options="x for x in prop.values">
    </select>
    <br>
    <br>
    <label for="itemDesc">Item Desc</label>
    <textarea rows="4" cols="50"name="itemDesc" id="itemDesc" value="Fill in the item Desc" ng-model="item.desc"></textarea>
    <br>
    <br>
    <label for="expDate">Expiry Date</label>
    <input type="date" name="expDate" id="expDate" value="Fill in the Exp Date" ng-model="item.expDate">
    <br>
    <br>
    <label for="itemLoc">Item Location</label>
    <input type="text" name="itemLoc" id="itemLoc" value="Pickup Location" ng-model="item.location">
    <button ng-click="getCurLoc();">Use Current Location</button>
    <br>
    <br>
    <div  map-lazy-load="https://maps.google.com/maps/api/js?key=AIzaSyCIdwRu4ngSUOFiSPAgCvN09Gp7PUtUy9c">
        <ng-map style="height: 400px; width:700px"
                center="current-position" zoom="10"
                default-style="false"
                geo-fallback-center="[60, 20]"
                geo-callback="vm.callbackFunc('you')"
        >
        </ng-map>
    </div>

    <br>
    <br>
    <button ng-click="submit()">Submit</button>
</form>

<script>

var latlongInput = document.getElementById('itemLoc');
var posLat;
var posLng;
// Try HTML5 geolocation.
// var map = new google.maps.Map(document.getElementById('map'), {
//   center: {lat: -34.397, lng: 150.644},
//   zoom: 6
// });
function getLoc(){
  if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(function(position) {
  var pos = {
    lat: position.coords.latitude,
    lng: position.coords.longitude
  };
          // console.log(JSON.stringify(pos));
          // locationInput.value = JSON.stringify(pos);
          posLat = pos.lat;
          posLng = pos.lng
          latlongInput.value = posLat + ", " + posLng;
          // map.setCenter(pos);
          console.log(latlongInput);

          var geocoder = new google.maps.Geocoder;

          var input = document.getElementById('latlng').value;
          var latlngStr = input.split(',', 2);
          var latlng = {lat: parseFloat(latlngStr[0]), lng: parseFloat(latlngStr[1])};
          geocoder.geocode({'location': latlng}, function(results, status) {
            if (status === 'OK') {
              if (results[1]) {
                map.setZoom(15);
                var marker = new google.maps.Marker({
                  position: latlng,
                  map: map
                });
                latlongInput.value = (results[1].formatted_address);
                console.log((results[1].formatted_address));
              } else {
                window.alert('No results found');
              }
            } else {
              window.alert('Geocoder failed due to: ' + status);
            }
          });
      });
    };
}
</script>
